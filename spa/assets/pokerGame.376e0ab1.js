import{i as C}from"./QBtn.0394bd0f.js";import{d as h,o as x,f as _,s as N,g,a as y,b as L,c as b}from"./firebase.b2c540bf.js";import{_ as K,u as O}from"./plugin-vue_export-helper.1e0f34b3.js";import{I as D,S as R,R as m,L as k,K as P,O as S,a3 as U,B as M,a4 as I,M as H,a5 as E,N as w}from"./index.5c085048.js";const F={data(){return{id:"",lobbyName:"test",yourTurn:0,raiseAmount:0,minRaise:2,winner:-1,currTurn:-1,players:[{hand:[],bestHand:[],money:100,folded:!1,remainingAmount:2,moneyBet:0,checked:!1}],cards:["/Cards/cardClubs2.png","/Cards/cardClubs3.png","/Cards/cardClubs4.png","/Cards/cardClubs5.png","/Cards/cardClubs6.png","/Cards/cardClubs7.png","/Cards/cardClubs8.png","/Cards/cardClubs9.png","/Cards/cardClubs10.png","/Cards/cardClubsJ.png","/Cards/cardClubsQ.png","/Cards/cardClubsK.png","/Cards/cardClubsA.png","/Cards/cardDiamonds2.png","/Cards/cardDiamonds3.png","/Cards/cardDiamonds4.png","/Cards/cardDiamonds5.png","/Cards/cardDiamonds6.png","/Cards/cardDiamonds7.png","/Cards/cardDiamonds8.png","/Cards/cardDiamonds9.png","/Cards/cardDiamonds10.png","/Cards/cardDiamondsJ.png","/Cards/cardDiamondsQ.png","/Cards/cardDiamondsK.png","/Cards/cardDiamondsA.png","/Cards/cardHearts2.png","/Cards/cardHearts3.png","/Cards/cardHearts4.png","/Cards/cardHearts5.png","/Cards/cardHearts6.png","/Cards/cardHearts7.png","/Cards/cardHearts8.png","/Cards/cardHearts9.png","/Cards/cardHearts10.png","/Cards/cardHeartsJ.png","/Cards/cardHeartsQ.png","/Cards/cardHeartsK.png","/Cards/cardHeartsA.png","/Cards/cardSpades2.png","/Cards/cardSpades3.png","/Cards/cardSpades4.png","/Cards/cardSpades5.png","/Cards/cardSpades6.png","/Cards/cardSpades7.png","/Cards/cardSpades8.png","/Cards/cardSpades9.png","/Cards/cardSpades10.png","/Cards/cardSpadesJ.png","/Cards/cardSpadesQ.png","/Cards/cardSpadesK.png","/Cards/cardSpadesA.png"]}},created(){this.update()},methods:{update(){const t=h(b,"Lobbies/test");x(t,l=>{if(l.exists()){const e=l.data();this.flipFlop(e),this.minRaise=e.minRaise,this.raiseAmount=e.raiseAmount,this.winner=e.winner,this.currTurn=e.turn,e.winner!=-1?(this.showPopUp("winningScreen"),document.getElementById("playerDeck").children[0].setAttribute("src","/Cards/cardBack_blue1.png"),document.getElementById("playerDeck").children[1].setAttribute("src","/Cards/cardBack_blue1.png")):this.closePopUp("winningScreen")}})},async signIn(){_.onAuthStateChanged(n=>{this.id=n.uid,this.createPlayer()}),N(_)},async initializeLobby(){const n="Lobbies/"+this.lobbyName,t=h(b,n);(await g(t)).exists()?console.log("already exists"):y(t,{startingAmount:100,winner:-1,numPlayers:0,pot:3,turn:2,flop:[],discardPile:[],players:[],raiseAmount:0,minRaise:2,amountToCheck:2,bettingRound:1,firstTurn:0}),this.createPlayer(),this.showPopUp("ids")},async createPlayer(){const n="Lobbies/"+this.lobbyName,t=h(b,n),e=(await g(t)).data();console.log(e);let a=!1;for(let s=0;s<e.players.length;s++)e.players[s].id==this.id&&(a=!0);if(!a){let s=0,r=!1;this.yourTurn=e.players.length,e.players.length==0?(s=1,r=!1):e.players.length==1&&(s=2,r=!0),e.players.push({hand:[],bestHand:[],money:100-s,folded:!1,remainingAmount:2-s,moneyBet:s,checked:r,id:this.id}),e.numPlayers++}y(t,e)},async dealCards(n){if(n.discardPile.length==0){console.log(n.discardPile);let t=Math.floor(Math.random()*52);n.discardPile.push(t);for(let l=0;l<n.numPlayers;l++)for(let e=0;e<2;e++){for(;n.discardPile.indexOf(t)>=0;)t=Math.floor(Math.random()*52);n.discardPile.push(t),n.players[l].hand.push(t)}for(let l=0;l<5;l++){for(;n.discardPile.indexOf(t)>=0;)t=Math.floor(Math.random()*52);n.discardPile.push(t),n.flop.push(t)}}},async startGame(){this.closePopUp("ids");const n="Lobbies/"+this.lobbyName,t=h(b,n),e=(await g(t)).data();this.dealCards(e),y(t,e)},async raise(){const n="Lobbies/"+this.lobbyName,t=h(b,n),e=(await g(t)).data();if(e.players[e.turn].id==this.id){e.raiseAmount=this.raiseAmount,e.players[e.turn].money-=e.raiseAmount+e.amountToCheck,e.pot+=e.raiseAmount+e.amountToCheck,e.amountToCheck+=e.raiseAmount,e.players[e.turn].remainingAmount=0,e.players[e.turn].moneyBet=e.amountToCheck,e.players[e.turn].checked=!0,e.minRaise=e.raiseAmount;for(let a=0;a<e.numPlayers;a++)a!=e.turn&&(e.players[a].remainingAmount=e.amountToCheck-e.players[a].moneyBet,e.players[a].checked=!1);for(e.turn==e.numPlayers-1?e.turn=0:e.turn++;e.players[e.turn].folded;)e.turn==e.numPlayers-1?e.turn=0:e.turn++;y(t,e)}else console.log("not your turn >:(")},async check(){const n="Lobbies/"+this.lobbyName,t=h(b,n),e=(await g(t)).data();if(e.players[e.turn].id==this.id){e.players[e.turn].remainingAmount=e.amountToCheck-e.players[e.turn].moneyBet,e.players[e.turn].money-=e.players[e.turn].remainingAmount,e.pot+=e.players[e.turn].remainingAmount,e.players[e.turn].moneyBet=e.amountToCheck,e.players[e.turn].remainingAmount=0,e.players[e.turn].checked=!0;let a=!0;for(let s=0;s<e.numPlayers;s++)!e.players[s].checked&&!e.players[s].folded&&(a=!1);if(a&&e.bettingRound==5)y(t,e),this.endGame();else if(a){for(e.bettingRound++,e.amountToCheck=0,e.turn=e.firstTurn;e.players[e.turn].folded;)e.turn++;for(let s=0;s<e.numPlayers;s++)e.players[s].checked=!1,e.players[s].moneyBet=0;y(t,e)}else if(e.turn==e.numPlayers-1){for(e.turn=0;e.players[e.turn].folded;)e.turn==e.numPlayers-1?e.turn=0:e.turn++;y(t,e)}else{for(e.turn++;e.players[e.turn].folded;)e.turn==e.numPlayers-1?e.turn=0:e.turn++;y(t,e)}}else console.log("not your turn >:(")},async fold(){const n="Lobbies/"+this.lobbyName,t=h(b,n),e=(await g(t)).data();if(e.players[e.turn].id==this.id){e.players[e.turn].folded=!0;let a=!0,s=0;for(let r=0;r<e.numPlayers;r++)!e.players[r].checked&&!e.players[r].folded&&(a=!1),e.players[r].folded&&s++;if(s==e.numPlayers-1)y(t,e),this.endGame();else if(a){for(e.bettingRound++,e.amountToCheck=0,e.turn=e.firstTurn;e.players[e.turn].folded;)e.turn++;for(let r=0;r<4;r++)e.players[r].checked=!1;y(t,e)}else if(e.turn==e.numPlayers-1){for(e.turn=0;e.players[e.turn].folded;)e.turn==e.numPlayers-1?e.turn=0:e.turn++;y(t,e)}else{for(e.turn++;e.players[e.turn].folded;)e.turn==e.numPlayers-1?e.turn=0:e.turn++;y(t,e)}}else console.log("not your turn >:(")},showPopUp(n){document.getElementById(n).style.display="block"},closePopUp(n){document.getElementById(n).style.display="none"},async flipCard(n){const t="Lobbies/"+this.lobbyName,l=h(b,t),a=(await g(l)).data();let r=document.getElementById("playerDeck").children[n];r.getAttribute("src")=="/Cards/cardBack_blue1.png"?r.setAttribute("src",this.cards[a.players[this.yourTurn].hand[n]]):r.setAttribute("src","/Cards/cardBack_blue1.png")},async flipFlop(n){let t=document.getElementById("flop");if(n.bettingRound==1)for(let l=0;l<5;l++)flop.children[l].setAttribute("src","/Cards/cardBack_blue1.png");else n.bettingRound==2?(t.children[0].setAttribute("src",this.cards[n.flop[0]]),t.children[1].setAttribute("src",this.cards[n.flop[1]])):n.bettingRound>=2&&t.children[n.bettingRound-1].setAttribute("src",this.cards[n.flop[n.bettingRound-1]])},async endGame(){let n,t=0,l;const e="Lobbies/"+this.lobbyName,a=h(b,e),r=(await g(a)).data();for(let i=0;i<r.numPlayers;i++)l=0,r.players[i].folded||(this.findBestHand(i,r),l=this.findRank(...r.players[i].bestHand),(t<l||t==l&&this.compareSameRank(...r.players[n].bestHand,...r.players[i].bestHand)==2)&&(t=l,n=i));r.players[n].money+=r.pot,r.winner=n+1,console.log(r),y(a,r),this.showPopUp("winningScreen")},async resetGame(){const n="Lobbies/"+this.lobbyName,t=h(b,n),e=(await g(t)).data();e.amountToCheck=2,e.bettingRound=1,e.discardPile=[],e.pot=3,e.flop=[],e.raiseAmount=0,e.amountToCheck=2,e.bettingRound=1,e.minRaise=2,e.winner=-1;let a;e.firstTurn+2==e.numPlayers-1?(a=e.numPlayers-1,e.turn=0,e.firstTurn++):e.firstTurn+1==e.numPlayers-1?(a=0,e.turn=1,e.firstTurn++):e.firstTurn==e.numPlayers-1?(a=1,e.turn=2,e.firstTurn=0):(e.firstTurn++,a=e.firstTurn+1,e.turn=e.firstTurn+2);for(let s=0;s<e.numPlayers;s++)e.players[s].hand=[],e.players[s].bestHand=[],e.players[s].folded=!1,e.players[s].remainingAmount=2,e.players[s].moneyBet=0,e.players[s].checked=!1,s==e.firstTurn?(e.players[s].money--,e.players[s].remainingAmount=1,e.players[s].moneyBet=1):s==a&&(e.players[s].money-=2,e.players[s].remainingAmount=0,e.players[s].moneyBet=2,e.players[s].checked=!0);this.dealCards(e),this.closePopUp("winningScreen"),y(t,e)},async deleteLobby(){const n="Lobbies/"+this.lobbyName,t=h(b,n);await L(t),window.location.href="/#/"},async findBestHand(n,t){let l=[...t.flop];l.push(t.players[n].hand[0]),l.push(t.players[n].hand[1]);let e=[],a=[],s=0,r;for(let i=0;i<7;i++)for(let c=i+1;c<7;c++){r=0,e=[];for(let o=0;o<7;o++)o!=i&&o!=c&&e.push(l[o]);e.sort(function(o,d){return o-d}),r=this.findRank(...e),(s<r||s==r&&this.compareSameRank(...a,...e)==2)&&(s=r,a=[...e],a.sort(function(o,d){return o-d}))}return t.players[n].bestHand=[...a],console.log(t.players[n].hand),console.log(a),console.log(s),s},findRank(n,t,l,e,a){let s=[n,t,l,e,a],r=[n,t,l,e,a],i=1;for(let p=0;p<5;p++)r[p]%=13;s.sort(function(p,A){return p-A}),r.sort(function(p,A){return p-A});let c=s[0]>=0&&s[4]<=12||s[0]>=13&&s[4]<=25||s[0]>=26&&s[4]<=38||s[0]>=39&&s[4]<=51,o=this.maxOfAKind(...r),d=o[1],u=o[0],B=r[4]-r[0]==4&&u==1,T=c&&B;return T&&r[4]==12?i=10:T?i=9:c?i=6:B?i=5:u==4?i=8:u==3?r[0]==d?r[3]!=r[4]?i=4:i=7:r[2]==d&&(r[0]!=r[1]?i=4:i=7):u==2&&(r[0]==d?r[2]==r[4]||r[2]==r[3]||r[3]==r[4]?i=3:i=2:r[1]==d&&r[3]==r[4]?i=3:i=2),i},compareSameRank(n,t,l,e,a,s,r,i,c,o){let d=[n,t,l,e,a],u=[s,r,i,c,o],B=[...d],T=[...u],p=0;for(let f=0;f<5;f++)d[f]%=13,u[f]%=13;let A=[...d],v=[...u];d=this.sort(...d),u=this.sort(...u);for(let f=4;f>=0&&p==0;f--)d[f]>u[f]?p=1:d[f]<u[f]&&(p=2);return p==0&&(B[A.indexOf(d[4])]>T[v.indexOf(u[4])]?p=1:p=2),p},sort(n,t,l,e,a){let s=[n,t,l,e,a];for(let d=0;d<5;d++)s[d]%=13;s.sort(function(d,u){return d-u});let r=this.maxOfAKind(...s),i=r[1],c=r[0],o=[];for(let d=0;d<5;d++)s[d]!=i&&o.push(s[d]);for(let d=0;d<c;d++)o.push(i);return(o[1]==o[2]||o[1]==s[0])&&o[2]!=i&&o[1]>i&&(o[3]=o[1],o[4]=o[1],o[1]=i,o[2]=i),c==1&&(o=[...s]),o},maxOfAKind(n,t,l,e,a){let s=[n,t,l,e,a],r,i=0,c;for(let o=0;o<5;o++){c=0;for(let d=0;d<5;d++)s[o]==s[d]&&c++;c>i&&(i=c,r=s[o])}return[i,r]}},computed:{minRaiseMet:function(){return this.raiseAmount>=this.minRaise},isYourTurn:function(){return this.yourTurn==this.currTurn}},mounted(){this.signIn(),this.lobbyName=O().lobbyName,this.initializeLobby()}},j={class:"absolute-center",style:{width:"40%",height:"50%","background-color":"white"},id:"ids"},G=m("p",null,"start game?",-1),V={class:"absolute-center",style:{width:"40%",height:"50%",display:"none","background-color":"white","z-index":"2"},id:"winningScreen"},Q={class:"absolute-center"},J={class:"absolute-center"},z=E('<div id="flop"><img id="flop1" src="/Cards/cardBack_blue1.png"><img id="flop2" src="/Cards/cardBack_blue1.png"><img id="flop3" src="/Cards/cardBack_blue1.png"><img id="flop4" src="/Cards/cardBack_blue1.png"><img id="flop5" src="/Cards/cardBack_blue1.png"></div>',1),Y={id:"playerDeck",class:"row no-wrap justify-start"},q={key:0,style:{width:"40%"}},W={style:{display:"none"},id:"myForm"};function X(n,t,l,e,a,s){return D(),R("div",null,[m("div",j,[G,k(C,{class:"absolute-bottom-left",onClick:s.startGame},{default:P(()=>[w("Yes")]),_:1},8,["onClick"])]),m("div",V,[m("p",Q,"Player "+S(this.winner)+" won!!!",1),k(C,{class:"absolute-bottom-left",onClick:s.resetGame},{default:P(()=>[w("Continue")]),_:1},8,["onClick"]),k(C,{class:"absolute-bottom-right",onClick:s.deleteLobby},{default:P(()=>[w("End Session")]),_:1},8,["onClick"])]),m("div",J,[z,m("div",Y,[m("img",{onClick:t[0]||(t[0]=r=>s.flipCard(0)),src:"/Cards/cardBack_blue1.png"}),m("img",{onClick:t[1]||(t[1]=r=>s.flipCard(1)),src:"/Cards/cardBack_blue1.png"}),s.isYourTurn?(D(),R("div",q,[k(C,{color:"warning",onClick:s.check,style:{height:"33%",width:"100%"},rounded:""},{default:P(()=>[w(" Check ")]),_:1},8,["onClick"]),k(C,{color:"positive",onClick:t[2]||(t[2]=r=>s.showPopUp("myForm")),style:{height:"33%",width:"100%"},rounded:""},{default:P(()=>[w(" Raise ")]),_:1}),k(C,{color:"negative",onClick:s.fold,style:{height:"33%",width:"100%"},rounded:""},{default:P(()=>[w(" Fold ")]),_:1},8,["onClick"]),m("div",W,[m("form",{onSubmit:t[6]||(t[6]=U((...r)=>s.raise&&s.raise(...r),["prevent"]))},[m("label",null,[m("b",null,"Raise By (minimum "+S(this.minRaise)+"): ",1)]),M(m("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=r=>a.raiseAmount=r),required:""},null,512),[[I,a.raiseAmount]]),s.minRaiseMet?(D(),R("button",{key:0,type:"submit",onClick:t[4]||(t[4]=r=>s.closePopUp("myForm"))},"Raise")):H("",!0),m("button",{type:"button",onClick:t[5]||(t[5]=r=>s.closePopUp("myForm"))},"cancel")],32)])])):H("",!0)])])])}var te=K(F,[["render",X]]);export{te as default};
